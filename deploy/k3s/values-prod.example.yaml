controlPlane:
  image:
    repository: ghcr.io/your-org/tracegate
    tag: "0.2.0"
  auth:
    apiInternalToken: REPLACE_API_INTERNAL_TOKEN
    agentAuthToken: REPLACE_AGENT_AUTH_TOKEN
    botToken: ""
  botWebhook:
    enabled: true
    publicHost: t.example.com
    publicPort: 8443
  postgres:
    password: REPLACE_DB_PASSWORD
  env:
    publicBaseUrl: https://cp.example.com
    defaultVpsTHost: vps-t.example.com
    defaultVpsEHost: vps-e.example.com
    realityPublicKey: REPLACE_REALITY_PUBLIC_KEY
    realityShortId: REPLACE_REALITY_SHORT_ID
    wireguardServerPublicKey: REPLACE_WG_SERVER_PUBLIC_KEY
    vlessWsPath: /ws
    vlessWsTlsPort: 443
    grafana:
      enabled: false

gateway:
  agentImage:
    repository: ghcr.io/your-org/tracegate
    tag: "0.2.0"

  vpsT:
    publicIPv4: 203.0.113.10
    fqdn: vps-t.example.com
    # Optional: proxied hostname for WS+TLS (e.g. ws-t.example.com with Cloudflare orange cloud).
    proxyFqdn: ""
    xray:
      config: |
        {
          "log": {"loglevel": "warning"},
          "inbounds": [{"tag":"vless-reality-in","listen":"0.0.0.0","port":443,"protocol":"vless","settings":{"clients":[],"decryption":"none"},"streamSettings":{"network":"tcp","security":"reality","realitySettings":{"show":false,"dest":"www.cloudflare.com:443","xver":0,"serverNames":["google.com","microsoft.com","yandex.ru","twitch.tv"],"privateKey":"REPLACE_PRIVATE_KEY","shortIds":["0123456789abcdef"]}}}],
          "outbounds": [{"protocol": "freedom", "tag": "direct"}]
        }
    hysteria:
      config: |
        listen: :443
        # For k3s mode, avoid ACME here: xray already occupies 443/tcp and ACME can hit rate limits.
        # Provide a cert via `gateway.vpsT.hysteriaTls` (recommended) or replace this config accordingly.
        tls:
          cert: /etc/hysteria/tls/tls.crt
          key: /etc/hysteria/tls/tls.key
        auth:
          type: userpass
          userpass:
            bootstrap: REPLACE_HYSTERIA_PASSWORD
        masquerade:
          type: file
          file:
            dir: /var/www/decoy
        trafficStats:
          listen: 127.0.0.1:9999
          secret: REPLACE_HYSTERIA_STATS_SECRET
    # Provide a TLS certificate for Hysteria2 (PEM). You can use a self-signed cert for v0.1,
    # but clients will need `insecure: true`.
    hysteriaTls:
      crt: ""
      key: ""
    wireguard:
      image: ghcr.io/your-org/tracegate-wireguard:0.2.0
      config: |
        [Interface]
        Address = 10.70.0.1/24
        ListenPort = 51820
        PrivateKey = REPLACE_WG_PRIVATE_KEY
        SaveConfig = false
    agent:
      authToken: REPLACE_AGENT_AUTH_TOKEN
      statsSecret: REPLACE_HYSTERIA_STATS_SECRET
      reloadXrayCmd: pkill -HUP xray || true
      reloadHysteriaCmd: pkill -HUP hysteria || true
      reloadWgCmd: wg-quick strip /etc/wireguard/wg0.conf | wg syncconf wg0 /dev/fd/0 || true

  vpsE:
    publicIPv4: 203.0.113.20
    fqdn: vps-e.example.com
    proxyFqdn: ""
    mode: tcpForward
    tcpForward:
      upstreamHost: vps-t.example.com
      upstreamPort: 443
    xray:
      config: |
        {
          "log": {"loglevel": "warning"},
          "inbounds": [{"tag":"entry-in","listen":"0.0.0.0","port":443,"protocol":"vless","settings":{"clients":[],"decryption":"none"},"streamSettings":{"network":"tcp","security":"reality","realitySettings":{"show":false,"dest":"vps-t.example.com:443","xver":0,"serverNames":["google.com","microsoft.com","yandex.ru","twitch.tv"],"privateKey":"REPLACE_PRIVATE_KEY","shortIds":["fedcba9876543210"]}}}],
          "outbounds": [{"tag":"to-transit","protocol":"freedom"}]
        }
    agent:
      authToken: REPLACE_AGENT_AUTH_TOKEN

observability:
  enabled: false
  grafana:
    # Optional; if empty, the chart will generate and persist a random password in a Secret.
    adminPassword: ""
